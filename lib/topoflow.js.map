{"version":3,"sources":["../src/topoflow.js"],"names":["d3","Flow","config","Nodes","Links","sourceNode","selectedElement","optionGroup","deleteAbleType","currentMouseXY","rwaElnContainer","document","querySelector","eln","classList","add","hasOwnProperty","initContextMenu","svg","select","style","attr","append","genUUID","height","pathGroup","nodeGroup","initDefs","initSvgEvent","Object","keys","nodeTemplate","map","type","deleteAble","push","contextmenu","render","onNodeContextMenuRender","bind","container","onClick","nodeInfo","iteminfo","contextmenuClick","call","onDataChange","defs","linkTemplate","dragLine","dragLink","innerHTML","arrowDefsDom","remove","selectAll","classed","onClearActiveElement","nodes","nodeIDs","item","selected","then","zoom","on","event","transform","scaleExtent","readOnly","xy","mouse","x","y","linkPoint","DragLinkEvent","drag","d","id","sourceEvent","target","parentNode","flag","forEach","v","nodeID","targetNode","addLink","point","onDragLink","nodaDrag","hotKey","nodeMouseXY","dragEvent","linksID","link","linkID","from","to","moveLink","addEventListener","e","keyCode","deleteNode","deleteLink","node","onDeleteNode","indexOf","console","log","clearAllActiveElement","onNodeClick","template","width","preventDefault","show","onSelectNode","selectNode","renderNode","operatingPoint","del_btn","points","calculateLinkPoint","gid","path"],"mappings":"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","file":"topoflow.js","sourcesContent":["import * as d3 from 'd3';\n\nimport contextmenu from './lib/contextmenu';\nimport mathLib from './lib/math';\nimport common from './lib/common';\n\nimport './styles/index.css';\n\nexport default class Flow {\n    // 设置默认值\n    constructor(config) {\n        this.config = config; // 初始化配置参数\n\n        this.Nodes = {}; // 当前画布中的节点信息(实时更新)\n        this.Links = {}; // 当前画布的线条信息\n        this.sourceNode = {}; //  源节点信息               \n        this.selectedElement = null; //当前选中节点的ID\n        this.optionGroup = null;  // 操作按钮元素\n        this.deleteAbleType = [];    // 允许删除的元素\n        this.currentMouseXY = {};\n\n\n        this.rwaElnContainer = document.querySelector(this.config.eln);\n\n        this.rwaElnContainer.classList.add('topoflow-container');\n\n        if (this.config.hasOwnProperty('onNodeContextMenuRender')) {\n            this.initContextMenu();\n        }\n\n        // 初始化画布\n        this.svg = d3\n            .select(config.eln)\n            .style('outline', 'none')\n            .attr('tabIndex', '0')\n            .append('svg')\n            .attr('id', `svg_${common.genUUID()}`)\n            .attr('width', '100%')\n            .attr('height', this.config.height);\n\n        // 初始化路径组信息\n        this.pathGroup = this.svg.append('svg:g').attr('class', 'data-flow-path-group');\n        this.nodeGroup = this.svg.append('svg:g').attr('class', 'data-flow-node-group');\n    }\n\n    // 组件初始化方法调用\n    init() {\n        this.initDefs();\n        this.initSvgEvent();\n\n        Object.keys(this.config.nodeTemplate).map((type) => {\n            let nodeTemplate = this.config.nodeTemplate[type];\n            if (!!nodeTemplate.deleteAble) {\n                this.deleteAbleType.push(type);\n            }\n        });\n    }\n\n\n    initContextMenu() {\n        // 初始化右键菜单\n        this.contextmenu = new contextmenu({\n            render: this.config.onNodeContextMenuRender.bind(this),\n            container: this.rwaElnContainer,\n            onClick: (nodeInfo, iteminfo) => {\n                if (!!this.config.contextmenuClick) {\n                    this.config.contextmenuClick.call(this, nodeInfo, iteminfo);\n                }\n            }\n        });\n    }\n\n    // 当图形发生变更的时候进行图形的变化\n    onDataChange() {\n        this.config.onDataChange();\n    }\n\n    // 初始化定义元素，如箭头\n    initDefs() {\n        let defs = this.svg.append('svg:defs').attr('id', 'arrow-defs');\n\n        // 自定义\n        if (this.config.hasOwnProperty('linkTemplate') && this.config.linkTemplate.hasOwnProperty('defs')) {\n            this.config.linkTemplate.defs(defs);\n        } else {\n            defs.append('svg:marker')\n                .attr('id', 'end-arrow')\n                .attr('viewBox', '0 -5 10 10')\n                .attr('refX', 6)\n                .attr('markerWidth', 5)\n                .attr('markerHeight', 5)\n                .attr('orient', 'auto')\n                .append('svg:path')\n                .attr('d', 'M0,-5L10,0L0,5');\n        }\n\n        this.dragLine = this.pathGroup.append('svg:path');\n        if (this.config.hasOwnProperty('linkTemplate') && this.config.linkTemplate.hasOwnProperty('dragLink')) {\n            this.config.linkTemplate.dragLink(this.dragLine)\n        } else {\n            this.dragLine.style('fill', 'white').style('marker-end', 'url(#end-arrow)').attr('class', 'dragline hide').attr('d', 'M0,0L0,0');\n        }\n    }\n\n    // 重置，将会删掉所有的线条和节点\n    reset() {\n        if (this.rwaElnContainer !== null) {\n            let pathGroup = this.rwaElnContainer.querySelector('.data-flow-path-group');\n            if (!!pathGroup) {\n                pathGroup.innerHTML = '';\n            }\n            let nodeGroup = this.rwaElnContainer.querySelector('.data-flow-node-group');\n            if (!!nodeGroup) {\n                nodeGroup.innerHTML = '';\n            }\n\n            let arrowDefsDom = this.rwaElnContainer.querySelector('#arrow-defs');\n            if (!!arrowDefsDom) {\n                arrowDefsDom.remove();\n            }\n        }\n        this.Nodes = [];\n        this.Links = [];\n        this.initDefs();\n        this.onDataChange();\n    }\n\n    // 清理所有选中的元素信息\n    clearAllActiveElement() {\n\n        this.selectedElement = null;\n\n        d3.selectAll('.link').style('marker-end', 'url(#end-arrow)');\n        d3.selectAll('.node').classed('active', false);\n        d3.selectAll('.link').classed('active', false);\n\n        if (!!this.optionGroup) {\n            this.optionGroup.remove();\n        }\n\n        if (!!this.config.onClearActiveElement) {\n            this.config.onClearActiveElement();\n        }\n\n        let nodes = this.Nodes;\n        let nodeIDs = Object.keys(nodes);\n\n        nodeIDs.map(item => {\n            this.Nodes[item].selected = false;\n        });\n        this.onDataChange();\n    }\n\n    zoom() {\n        let then = this;\n\n        // 画布移动缩放        \n        let zoom = d3.zoom().on('zoom', function () {\n            d3.selectAll(`${then.config.eln} .data-flow-path-group, ${then.config.eln} .data-flow-node-group`).attr('transform', d3.event.transform);\n        });\n\n        // 限制缩放的范围\n        zoom.scaleExtent([0.7, 1.5]);\n\n        // 使用移动和缩放并禁用双击\n        this.svg.call(zoom).on('dblclick.zoom', null);\n    }\n\n    // svg画布的事件绑定\n    initSvgEvent() {\n        let then = this;\n\n        this.zoom();\n\n        if (!!!this.config.readOnly) {\n            this.svg.on('mousemove', function () {\n                let xy = d3.mouse(this);\n                then.currentMouseXY = {\n                    x: xy[0],\n                    y: xy[1]\n                };\n            });\n\n            // 鼠标线条的操作\n            let linkPoint = [0, 0, 0, 0];\n            this.DragLinkEvent = d3.drag()\n                .on('start', function (d) {     // 设置线条的起始点\n                    linkPoint = [d3.event.x, d3.event.y];\n                    then.sourceNode = then.Nodes[then.selectedElement.id];\n                })\n                .on('drag', function (d) {      // 线条跟随鼠标位置\n                    linkPoint[2] = d3.event.x;\n                    linkPoint[3] = d3.event.y;\n                    then.dragLine.classed('hide', false).attr('d', `M${linkPoint[0]},${linkPoint[1]}L${linkPoint[2]},${linkPoint[3]}`);\n                })\n                .on('end', function () {\n                    then.dragLine.classed('hide', true);\n                    let classList = d3.event.sourceEvent.target.parentNode.classList;\n                    let flag = 0;\n                    classList.forEach(v => {\n                        if (v === 'data-flow-path-group') {\n                            flag = 1;\n                        } else if (v === 'node') {\n                            flag = 2;\n                        }\n                    });\n\n                    if (flag === 2) {\n                        let nodeID = d3.event.sourceEvent.target.parentNode.id;\n                        let targetNode = then.Nodes[nodeID];\n                        then.addLink(then.sourceNode, targetNode);\n                    }\n                    if (then.config.hasOwnProperty('onDragLink')) {\n                        let point = [d3.event.x, d3.event.y];\n                        then.config.onDragLink(then.sourceNode, point, flag === 2);\n                    }\n\n                    then.sourceNode = {};\n                    then.onDataChange();\n                });\n                \n            this.nodaDrag();\n            this.hotKey();\n        }\n    }\n\n    // 节点拖拽事件\n    nodaDrag() {\n        let nodeMouseXY = [];\n        let then = this;\n        this.dragEvent = d3.drag()\n            .on('start', function () {\n                nodeMouseXY = d3.mouse(this);\n                if (!!then.optionGroup) {\n                    then.optionGroup.remove();\n                }\n            })\n            .on('drag', function (d) {\n                let point = {\n                    x: d3.event.x - nodeMouseXY[0],\n                    y: d3.event.y - nodeMouseXY[1]\n                };\n\n                d3.select(this).attr('transform', `translate(${point.x},${point.y})`);\n\n                // 移动节点,线条跟着变化\n                let nodeID = this.id;\n\n                then.Nodes[nodeID].x = point.x;\n                then.Nodes[nodeID].y = point.y;\n\n                let linksID = Object.keys(then.Links);\n                linksID.map(linkID => {\n                    let link = then.Links[linkID];\n                    if (nodeID === link.from || nodeID === link.to) {\n                        then.moveLink(link, linkID);\n                    }\n                });\n            })\n            .on('end', function () {\n                then.onDataChange();\n            });\n    }\n\n    // 删除节点和线条的快捷键\n    hotKey() {\n        let then = this;\n        document.querySelector(this.config.eln).addEventListener('keydown', function (e) {\n            if (!!then.selectedElement && (e.keyCode === 8 || e.keyCode === 46)) {\n                if (then.selectedElement.type === 'node') {\n                    then.deleteNode(then.selectedElement.id);\n                } else {\n                    let link = then.Links[then.selectedElement.id];\n                    then.deleteLink(link);\n                }\n            }\n        });\n    }\n\n    // 删除节点\n    deleteNode(nodeID) {\n        let node = this.Nodes[nodeID];\n        if (!!!node) {\n            return false;\n        }\n\n        if (this.config.hasOwnProperty('onDeleteNode')) {\n            if (!this.config.onDeleteNode(node)) {\n                return;\n            }\n        }\n\n        if (this.deleteAbleType.indexOf(node.type) === -1) {\n            console.log('Not allowed to delete type ' + node.type);\n            return false;\n        }\n\n        delete this.Nodes[nodeID];\n        d3.select('#' + nodeID).remove();\n\n        let linksID = Object.keys(this.Links);\n        linksID.map((linkID) => {\n            let link = this.Links[linkID];\n            if (link.from === nodeID || link.to === nodeID) {\n                this.deleteLink(link);\n            }\n        });\n\n        if (!!this.optionGroup) {\n            this.optionGroup.remove();\n        }\n\n        this.onDataChange();\n    }\n\n    // 选中节点\n    selectNode(nodeID) {\n        this.clearAllActiveElement()\n        let nodeInfo = this.Nodes[nodeID];\n        nodeInfo.selected = true;\n\n        let node = d3.select(`#${nodeID}`);\n        node.classed('active', true)\n\n        this.selectedElement = {\n            type: 'node',\n            id: nodeID\n        };\n        this.onNodeClick(node, nodeInfo)\n    }\n\n    // 新增一个节点\n    addNode(nodeInfo) {\n        let then = this;\n\n        if (!!!nodeInfo.id) {\n            nodeInfo.id = 'node_' + common.genUUID();\n        }\n\n        if (!this.config.nodeTemplate.hasOwnProperty(nodeInfo.type)) {\n            return;\n        }\n\n        let template = this.config.nodeTemplate[nodeInfo.type];\n\n        nodeInfo.width = template.width;\n        nodeInfo.height = template.height;\n\n        let node = this.nodeGroup\n            .append('g')\n            .attr('class', 'node')\n            .attr('id', nodeInfo.id)\n            .on('contextmenu', function () {\n                d3.event.preventDefault();\n                if (then.config.hasOwnProperty('onNodeContextMenuRender')) {\n                    then.contextmenu.show(nodeInfo, then.currentMouseXY);\n                }\n            })\n            .on('click', function () {\n                then.config.onSelectNode(this, nodeInfo);\n                then.selectNode(nodeInfo.id);\n                then.onNodeClick(node, nodeInfo);                \n            })\n            .attr('transform', `translate(${nodeInfo.x}, ${nodeInfo.y})`);\n\n\n        if (!!this.dragEvent) {\n            node.call(this.dragEvent);\n        }\n\n        // 调用参数定义的        \n        this.config.nodeTemplate[nodeInfo.type].renderNode(node, nodeInfo);\n\n        // 保存节点信息        \n        this.Nodes[nodeInfo.id] = nodeInfo;\n        this.onDataChange();\n        return nodeInfo;\n    }\n\n    onNodeClick(node, nodeInfo) {\n        let then = this;\n        this.sourceNode = nodeInfo;\n\n        if (!!this.optionGroup) {\n            this.optionGroup.remove();\n        }\n\n        this.optionGroup = this.nodeGroup.append('g');\n        if (!!!this.config.readOnly) {\n            this.optionGroup.append('rect')\n                .style('fill', 'none')\n                .style('stroke', '#68a987')\n                .style('stroke-width', '1px')\n                .attr('width', nodeInfo.width)\n                .attr('height', nodeInfo.height)\n                .attr('transform', `translate(${nodeInfo.x}, ${nodeInfo.y}) `);\n\n            this.config.nodeTemplate[nodeInfo.type].operatingPoint.forEach((item) => {\n                then.optionGroup\n                    .append('svg:circle')\n                    .attr('class', 'operating-point')\n                    .attr('r', 5)\n                    .attr('fill', 'white')\n                    .attr('stroke', '#06a0e9')\n                    .attr('transform', () => {\n                        if (item === 'right') {\n                            return `translate(${nodeInfo.x + nodeInfo.width}, ${nodeInfo.y + nodeInfo.height / 2})`;\n                        } else if (item === 'left') {\n                            return `translate(${nodeInfo.x}, ${nodeInfo.y + nodeInfo.height / 2})`;\n                        }\n                    }).call(then.DragLinkEvent);\n            });\n\n\n            // 删除按钮\n            let del_btn = this.optionGroup\n                .append('g')\n                .attr('class', 'delete-not-btn')\n                .attr('transform', `translate(${nodeInfo.width + nodeInfo.x}, ${nodeInfo.y}) `);\n\n            del_btn\n                .append('svg:circle')\n                .attr('stroke', 'red')\n                .attr('fill', 'red')\n                .attr('r', 6);\n\n            del_btn\n                .append('svg:path')\n                .attr('stroke', 'white')\n                .attr('stroke-width', 2)\n                .attr('d', 'M-3,-3L3,3');\n\n            del_btn\n                .append('svg:path')\n                .attr('stroke', 'white')\n                .attr('stroke-width', 2)\n                .attr('d', 'M3,-3L-3,3');\n\n            del_btn.on('click', function () {\n                console.log('delete node', nodeInfo);\n                then.deleteNode(nodeInfo.id);\n            });\n        }\n    }\n\n    // 移动节点的时候节点相关的线条跟着移动\n    moveLink(link, linkID) {\n        let sourceNode = this.Nodes[link.from];\n        let targetNode = this.Nodes[link.to];\n\n        let points = mathLib.calculateLinkPoint(sourceNode, targetNode, this.config);\n\n        d3.select(`#${linkID}`).attr('d', `M${points[0]},${points[1]}L${points[2]}, ${points[3]}`);\n    }\n\n    // 增加线条\n    addLink(sourceNode, targetNode) {\n        let then = this;\n        let gid = 'link_' + common.genUUID();\n        let points = mathLib.calculateLinkPoint(sourceNode, targetNode, this.config);\n\n        let path = this.pathGroup.append('svg:path').attr('id', gid).attr('class', 'link');\n\n        if (this.config.hasOwnProperty('linkTemplate') && this.config.linkTemplate.hasOwnProperty('path')) {\n            this.config.linkTemplate.path(path);\n        } else {\n            path.style('marker-end', 'url(#end-arrow)')\n        }\n\n        path.attr('d', `M${points[0]}, ${points[1]}L${points[2]}, ${points[3]}`)\n            .on('click', () => {\n                then.clearAllActiveElement();\n                path.classed('active', true);\n                then.selectedElement = {\n                    type: 'link',\n                    id: gid\n                };\n            });\n\n        this.Links[gid] = {\n            id: gid,\n            from: sourceNode.id,\n            to: targetNode.id\n        };\n\n        this.onDataChange();\n    }\n\n    deleteLink(link) {\n        delete this.Links[link.id];\n        d3.select(`#${link.id}`).remove();\n        this.onDataChange();\n    }\n}"]}